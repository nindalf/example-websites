<!DOCTYPE html><html lang="en"><head><meta name="viewport" content="width=device-width" /><meta charSet="utf-8" /><link rel="icon" href="/favicon.ico" /><title>Remaking this blog for fun and learning</title><meta name="charset" content="utf-8" /><meta name="author" content="Krishna Sundarram" /><meta name="description" content="Krishna&#x27;s personal blog" /><link href="https://blog.nindalf.com/index.xml" rel="alternate" type="application/rss+xml" title="Krishna&#x27;s personal blog" /><meta name="next-head-count" content="8" /><link rel="preload" href="/_next/static/css/37c6e985df8853b529b3.css" as="style" /><link rel="stylesheet" href="/_next/static/css/37c6e985df8853b529b3.css" data-n-g="" /><link rel="preload" href="/_next/static/css/740b20632ac80250c7f0.css" as="style" /><link rel="stylesheet" href="/_next/static/css/740b20632ac80250c7f0.css" data-n-p="" /><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/webpack-18c200bfa4628d9da94c.js" as="script" /><link rel="preload" href="/_next/static/chunks/framework-5e33f488d9410ce9ba9d.js" as="script" /><link rel="preload" href="/_next/static/chunks/597-e9cbf8ad4e8557f256b3.js" as="script" /><link rel="preload" href="/_next/static/chunks/778-c9e86f308cd9cb372f22.js" as="script" /><link rel="preload" href="/_next/static/chunks/main-9ca82ec4d4aca520c43d.js" as="script" /><link rel="preload" href="/_next/static/chunks/pages/_app-33eebf5131cfd5d17810.js" as="script" /><link rel="preload" href="/_next/static/chunks/941-89b1c2f25315e4a44edb.js" as="script" /><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-4aeed08a217f27d1079a.js" as="script" /></head><body><div id="__next"><div><header class="utils_header__1rqd-"><ul class="utils_headingLg__de7p0"><li class="utils_headingLg__de7p0"><a href="/about/">About</a></li><li class="utils_headingLg__de7p0"><a href="/">Home</a></li></ul></header><main><article><h1>Remaking this blog for fun and learning</h1><div class="utils_lightText__12Ckm"><time dateTime="2021-04-17">April 17, 2021</time> <div>6<!-- --> min read</div></div><div><p>I wrote about <a href="/posts/setting-up-this-blog/">setting up this blog</a> a couple of years ago. It was simple - I would <code>git push</code> a new post to my rented server, where the <code>hugo</code> static site generator would convert it to <code>.html</code> files served by nginx. This worked well, I had no complaints.</p>
<p>Except. Dark mode and syntax highlighting (for programming snippets) would be nice. I use dark mode everywhere and it irked me that my own site didn't support it. I could have modified the blog's existing theme to add these features, but where's the fun in that? Also, I wanted private drafts because it's important to <a href="/posts/writing-helps-me-think/">my writing flow</a>.</p>
<p>I started with <a href="https://next-learn-starter.vercel.app">this template</a> and modified it till it looked like <a href="https://blog-template.nindalf.com">this</a>. Along the way I added dark mode, syntax highlighting and a few features I had on the previous website - RSS subscriptions, tags and time to read a post. I would have added private drafts, but this was solved by changing how I deployed the website. I moved from hosting myself to <a href="https://pages.cloudflare.com">Cloudflare Pages</a>, which gave me private drafts for free.</p>
<p>This is my current flow</p>
<ol>
<li>Write a post in markdown.</li>
<li><code>git commit</code> and <code>gh pr create</code>.</li>
<li>Cloudflare's bot comments on the Pull Request (PR) with a link to a <a href="https://f11b3a44.blog-ajhz.pages.dev">private draft</a>.</li>
<li>I share the link with people, get feedback and update the PR.</li>
<li>When it's done, merge the PR. It appears on <code>blog.nindalf.com</code> automatically.</li>
</ol>
<p>If this flow appeals to you, you can check out the <a href="https://github.com/nindalf/blog-template">template</a> and modify it to suit your needs.</p>
<p><img src="/images/pullrequest.png" alt="Pull request for this article"></p>
<hr>
<h2>Things I learned along the way</h2>
<p>I've been working in a large tech company in the last few years. Most of the infra and tools are built within. I admit, I haven't kept up with all the developments in dev infra in the outside world. While many of these things might be obvious to you, it wasn't to me and I enjoyed learning about them.</p>
<h3>Core Web Vitals</h3>
<p>Apart from latency, it's not easy to agree on what metrics measure web performance well. In May 2020, the Chrome team <a href="https://blog.chromium.org/2020/05/introducing-web-vitals-essential-metrics.html">announced Core Web Vitals</a> a set of metrics and tools that would do that. Later that month, the Google Search team announced that "page experience" would be measured by these metrics. Sites with good page experience would benefit from <a href="https://developers.google.com/search/blog/2020/11/timing-for-page-experience">improved ranking</a>. That's a good enough reason for most web developers to prioritize this. Past google initiatives, like <a href="https://developers.google.com/search/blog/2014/08/https-as-ranking-signal">rewarding the adoption of HTTPS</a> contributed to HTTPS becoming <a href="https://transparencyreport.google.com/https/overview?hl=en_GB">nearly ubiquitous</a></p>
<p><img src="https://1.bp.blogspot.com/-cZvSfEG871E/Xs7lqHw77mI/AAAAAAAAEF4/BCRM01I7VMgplaofXcKpDRewHM3jwAkuwCLcBGAsYHQ/s1600/Search_Page_Experience_Graphic.webp" alt="Google&#x27;s page experience criteria"></p>
<p>It's 3 metrics for now, but will change in future.</p>
<blockquote>
<ul>
<li><a href="https://web.dev/lcp/">Largest Contentful Paint</a> measures perceived load speed and marks the point in the page load timeline when the page's main content has likely loaded.</li>
<li><a href="https://web.dev/fid/">First Input Delay</a> measures responsiveness and quantifies the experience users feel when trying to first interact with the page.</li>
<li><a href="https://web.dev/cls/">Cumulative Layout Shift</a> measures visual stability and quantifies the amount of unexpected layout shift of visible page content.</li>
</ul>
</blockquote>
<p>Here was my experience - I found variance while measuring these. Often I'd re-run it on the same website within seconds of the previous run and get different results. The variance was higher on Google's <a href="https://developers.google.com/speed/pagespeed/insights/">PageSpeed Insights</a> page compared to Chrome DevTools. This is unsurprising because these metrics are dependent on both the client's network and the client's hardware. Their Insights page probably runs on shared hardware, accounting for that variance.</p>
<p><img src="/images/pagespeedonnew.svg" alt="Using PageSpeed Insights on the same site in succession"></p>
<p>I figure the right way to track these metrics is using DevTools during development to get a rough idea. I would add them to CI but only to measure large regressions. If the CI is running on shared hardware, these metrics will be noisy. Lastly, I would log these metrics client side from users. This helps us track the experience of actual users, accounting for real world network and devices. It also averages out the noise that we might see if we only took a few ad-hoc measurements on dev machines.</p>
<p>DevTools also tracks 3 other areas (Accessibility, Best Practices, SEO) in addition to Performance, with helpful suggestions for each. For example, I wasn't setting the lang attribute on the topmost <code>&#x3C;html></code> tag. This matters to folks with screenreaders. The new blog does better than the <a href="https://blog-hugo.nindalf.com">previous one</a>, scoring 100 in all areas.</p>
<p><img src="/images/oldvsnew.svg" alt="Comparing the performance of old blog with new"></p>
<h3>Impact of CDN</h3>
<p>It's obvious that CDNs reduce the latency of serving static resources. I was still impressed by the level of improvement, as well as how easy it was to enable the CDN. I measured the min, mean, p50, p90 and p95 responses for the old and new blogs, on CDN and off. </p>
<p>As expected, both blogs on CDN remained low latency from all locations I tested - Oregon, London, Singapore, Sydney. The latency for the non-CDN sites increased with distance from Bangalore, the location of the server. Takeaway - you could get away without a CDN if your users are mostly in one region. But honestly, why would you?</p>
<p><img src="/images/Singapore.svg" alt="Singapore"></p>
<p><img src="/images/London.svg" alt="London"></p>
<p><img src="/images/Sydney.svg" alt="Sydney"></p>
<p><img src="/images/Oregon.svg" alt="Oregon"></p>
<h3>Edge computing</h3>
<p>I was aware this existed, but until I tried it I had no idea how easy it was to develop and deploy. It took me only a few minutes to deploy a simple worker that would send a customised <a href="/robots.txt"><code>robots.txt</code></a> depending on the Hostname. Delving into this further, I found the pricing is so competitive that I'd have to seriously consider it while architecting for bursty loads. </p>
<p>I find that AWS Lambda and it's competitors are priced well too. I tried Lambda for a bit but the dev experience wasn't as sharp.</p>
<h3>RSS</h3>
<p>There wasn't much to learn here. Turns out the format for RSS is straightforward. It's simple to generate the XML through string concatenation and write it to the appropriate location - <a href="/index.xml"><code>root/index.xml</code></a>.</p>
<h3>CSS</h3>
<p><img src="/images/squidward.webp" alt="Squidward afraid of CSS"></p>
<p>As a backend developer, I'm a bit like Squidward here. But creating the blog from scratch meant I couldn't avoid messing around with CSS. It was a good opportunity to flex rarely used muscles and to learn about (relatively) new approaches to writing CSS like Tailwind.</p>
<hr>
<h2>Keep learning</h2>
<p>I learned so much from just a few hours of making something simple. I hope this post is a reminder to myself to keep investing this time now and then.</p>
</div></article></main><div class="utils_backToHome__2ednK"><a href="/">‚Üê Home</a></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"remaking-this-blog","wordCount":1014,"timeToRead":6,"contentHtml":"\u003cp\u003eI wrote about \u003ca href=\"/posts/setting-up-this-blog/\"\u003esetting up this blog\u003c/a\u003e a couple of years ago. It was simple - I would \u003ccode\u003egit push\u003c/code\u003e a new post to my rented server, where the \u003ccode\u003ehugo\u003c/code\u003e static site generator would convert it to \u003ccode\u003e.html\u003c/code\u003e files served by nginx. This worked well, I had no complaints.\u003c/p\u003e\n\u003cp\u003eExcept. Dark mode and syntax highlighting (for programming snippets) would be nice. I use dark mode everywhere and it irked me that my own site didn't support it. I could have modified the blog's existing theme to add these features, but where's the fun in that? Also, I wanted private drafts because it's important to \u003ca href=\"/posts/writing-helps-me-think/\"\u003emy writing flow\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eI started with \u003ca href=\"https://next-learn-starter.vercel.app\"\u003ethis template\u003c/a\u003e and modified it till it looked like \u003ca href=\"https://blog-template.nindalf.com\"\u003ethis\u003c/a\u003e. Along the way I added dark mode, syntax highlighting and a few features I had on the previous website - RSS subscriptions, tags and time to read a post. I would have added private drafts, but this was solved by changing how I deployed the website. I moved from hosting myself to \u003ca href=\"https://pages.cloudflare.com\"\u003eCloudflare Pages\u003c/a\u003e, which gave me private drafts for free.\u003c/p\u003e\n\u003cp\u003eThis is my current flow\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eWrite a post in markdown.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003egit commit\u003c/code\u003e and \u003ccode\u003egh pr create\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eCloudflare's bot comments on the Pull Request (PR) with a link to a \u003ca href=\"https://f11b3a44.blog-ajhz.pages.dev\"\u003eprivate draft\u003c/a\u003e.\u003c/li\u003e\n\u003cli\u003eI share the link with people, get feedback and update the PR.\u003c/li\u003e\n\u003cli\u003eWhen it's done, merge the PR. It appears on \u003ccode\u003eblog.nindalf.com\u003c/code\u003e automatically.\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eIf this flow appeals to you, you can check out the \u003ca href=\"http://github.com/nindalf/blog-template\"\u003etemplate\u003c/a\u003e and modify it to suit your needs.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/pullrequest.png\" alt=\"Pull request for this article\"\u003e\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003eThings I learned along the way\u003c/h2\u003e\n\u003cp\u003eI've been working in a large tech company in the last few years. Most of the infra and tools are built within. I admit, I haven't kept up with all the developments in dev infra in the outside world. While many of these things might be obvious to you, it wasn't to me and I enjoyed learning about them.\u003c/p\u003e\n\u003ch3\u003eCore Web Vitals\u003c/h3\u003e\n\u003cp\u003eApart from latency, it's not easy to agree on what metrics measure web performance well. In May 2020, the Chrome team \u003ca href=\"https://blog.chromium.org/2020/05/introducing-web-vitals-essential-metrics.html\"\u003eannounced Core Web Vitals\u003c/a\u003e a set of metrics and tools that would do that. Later that month, the Google Search team announced that \"page experience\" would be measured by these metrics. Sites with good page experience would benefit from \u003ca href=\"https://developers.google.com/search/blog/2020/11/timing-for-page-experience\"\u003eimproved ranking\u003c/a\u003e. That's a good enough reason for most web developers to prioritize this. Past google initiatives, like \u003ca href=\"https://developers.google.com/search/blog/2014/08/https-as-ranking-signal\"\u003erewarding the adoption of HTTPS\u003c/a\u003e contributed to HTTPS becoming \u003ca href=\"https://transparencyreport.google.com/https/overview?hl=en_GB\"\u003enearly ubiquitous\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://1.bp.blogspot.com/-cZvSfEG871E/Xs7lqHw77mI/AAAAAAAAEF4/BCRM01I7VMgplaofXcKpDRewHM3jwAkuwCLcBGAsYHQ/s1600/Search_Page_Experience_Graphic.webp\" alt=\"Google\u0026#x27;s page experience criteria\"\u003e\u003c/p\u003e\n\u003cp\u003eIt's 3 metrics for now, but will change in future.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://web.dev/lcp/\"\u003eLargest Contentful Paint\u003c/a\u003e measures perceived load speed and marks the point in the page load timeline when the page's main content has likely loaded.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://web.dev/fid/\"\u003eFirst Input Delay\u003c/a\u003e measures responsiveness and quantifies the experience users feel when trying to first interact with the page.\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://web.dev/cls/\"\u003eCumulative Layout Shift\u003c/a\u003e measures visual stability and quantifies the amount of unexpected layout shift of visible page content.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eHere was my experience - I found variance while measuring these. Often I'd re-run it on the same website within seconds of the previous run and get different results. The variance was higher on Google's \u003ca href=\"https://developers.google.com/speed/pagespeed/insights/\"\u003ePageSpeed Insights\u003c/a\u003e page compared to Chrome DevTools. This is unsurprising because these metrics are dependent on both the client's network and the client's hardware. Their Insights page probably runs on shared hardware, accounting for that variance.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/pagespeedonnew.svg\" alt=\"Using PageSpeed Insights on the same site in succession\"\u003e\u003c/p\u003e\n\u003cp\u003eI figure the right way to track these metrics is using DevTools during development to get a rough idea. I would add them to CI but only to measure large regressions. If the CI is running on shared hardware, these metrics will be noisy. Lastly, I would log these metrics client side from users. This helps us track the experience of actual users, accounting for real world network and devices. It also averages out the noise that we might see if we only took a few ad-hoc measurements on dev machines.\u003c/p\u003e\n\u003cp\u003eDevTools also tracks 3 other areas (Accessibility, Best Practices, SEO) in addition to Performance, with helpful suggestions for each. For example, I wasn't setting the lang attribute on the topmost \u003ccode\u003e\u0026#x3C;html\u003e\u003c/code\u003e tag. This matters to folks with screenreaders. The new blog does better than the \u003ca href=\"https://blog-hugo.nindalf.com\"\u003eprevious one\u003c/a\u003e, scoring 100 in all areas.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/oldvsnew.svg\" alt=\"Comparing the performance of old blog with new\"\u003e\u003c/p\u003e\n\u003ch3\u003eImpact of CDN\u003c/h3\u003e\n\u003cp\u003eIt's obvious that CDNs reduce the latency of serving static resources. I was still impressed by the level of improvement, as well as how easy it was to enable the CDN. I measured the min, mean, p50, p90 and p95 responses for the old and new blogs, on CDN and off. \u003c/p\u003e\n\u003cp\u003eAs expected, both blogs on CDN remained low latency from all locations I tested - Oregon, London, Singapore, Sydney. The latency for the non-CDN sites increased with distance from Bangalore, the location of the server. Takeaway - you could get away without a CDN if your users are mostly in one region. But honestly, why would you?\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/Singapore.svg\" alt=\"Singapore\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/London.svg\" alt=\"London\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/Sydney.svg\" alt=\"Sydney\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/images/Oregon.svg\" alt=\"Oregon\"\u003e\u003c/p\u003e\n\u003ch3\u003eEdge computing\u003c/h3\u003e\n\u003cp\u003eI was aware this existed, but until I tried it I had no idea how easy it was to develop and deploy. It took me only a few minutes to deploy a simple worker that would send a customised \u003ca href=\"/robots.txt\"\u003e\u003ccode\u003erobots.txt\u003c/code\u003e\u003c/a\u003e depending on the Hostname. Delving into this further, I found the pricing is so competitive that I'd have to seriously consider it while architecting for bursty loads. \u003c/p\u003e\n\u003cp\u003eI find that AWS Lambda and it's competitors are priced well too. I tried Lambda for a bit but the dev experience wasn't as sharp.\u003c/p\u003e\n\u003ch3\u003eRSS\u003c/h3\u003e\n\u003cp\u003eThere wasn't much to learn here. Turns out the format for RSS is straightforward. It's simple to generate the XML through string concatenation and write it to the appropriate location - \u003ca href=\"/index.xml\"\u003e\u003ccode\u003eroot/index.xml\u003c/code\u003e\u003c/a\u003e.\u003c/p\u003e\n\u003ch3\u003eCSS\u003c/h3\u003e\n\u003cp\u003e\u003cimg src=\"/images/squidward.webp\" alt=\"Squidward afraid of CSS\"\u003e\u003c/p\u003e\n\u003cp\u003eAs a backend developer, I'm a bit like Squidward here. But creating the blog from scratch meant I couldn't avoid messing around with CSS. It was a good opportunity to flex rarely used muscles and to learn about (relatively) new approaches to writing CSS like Tailwind.\u003c/p\u003e\n\u003chr\u003e\n\u003ch2\u003eKeep learning\u003c/h2\u003e\n\u003cp\u003eI learned so much from just a few hours of making something simple. I hope this post is a reminder to myself to keep investing this time now and then.\u003c/p\u003e\n","preview":"I wrote about setting up this blog a couple of years ago. It was simple - I would git push a new post to my rented server, where the hugo static site generator would convert it to .html files served by nginx. This worked well, I had no complaints.","title":"Remaking this blog for fun and learning","date":"2021-04-17","tags":["tech"]}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"remaking-this-blog"},"buildId":"Jf-wop3a-jR8I9PxYMsgo","isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-8683bd742a84c1edd48c.js"></script><script src="/_next/static/chunks/webpack-18c200bfa4628d9da94c.js" async=""></script><script src="/_next/static/chunks/framework-5e33f488d9410ce9ba9d.js" async=""></script><script src="/_next/static/chunks/597-e9cbf8ad4e8557f256b3.js" async=""></script><script src="/_next/static/chunks/778-c9e86f308cd9cb372f22.js" async=""></script><script src="/_next/static/chunks/main-9ca82ec4d4aca520c43d.js" async=""></script><script src="/_next/static/chunks/pages/_app-33eebf5131cfd5d17810.js" async=""></script><script src="/_next/static/chunks/941-89b1c2f25315e4a44edb.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-4aeed08a217f27d1079a.js" async=""></script><script src="/_next/static/Jf-wop3a-jR8I9PxYMsgo/_buildManifest.js" async=""></script><script src="/_next/static/Jf-wop3a-jR8I9PxYMsgo/_ssgManifest.js" async=""></script><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "e957a0fd477941f5a9aa5fc4be0670df"}'></script></body></html>